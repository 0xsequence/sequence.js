/* eslint-disable */
// userdata v0.1.0 88764bb5f99353e11d849a1aa8f8a998501ffedb
// --
// Code generated by Webrpc-gen@v0.30.2 with typescript generator. DO NOT EDIT.
//
// webrpc-gen -schema=userdata.ridl -target=typescript -client -out=./clients/userdata.gen.ts

// Webrpc description and code-gen version
export const WebrpcVersion = 'v1'

// Schema version of your RIDL schema
export const WebrpcSchemaVersion = 'v0.1.0'

// Schema hash generated from your RIDL schema
export const WebrpcSchemaHash = '88764bb5f99353e11d849a1aa8f8a998501ffedb'

//
// Client interface
//

export interface UserDataClient {
  getCapabilities(headers?: object, signal?: AbortSignal): Promise<GetCapabilitiesResponse>

  getAccessToken(req: GetAccessTokenRequest, headers?: object, signal?: AbortSignal): Promise<GetAccessTokenResponse>

  getIdentityToken(
    req: GetIdentityTokenRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<GetIdentityTokenResponse>

  getWalletPreferences(
    req: GetWalletPreferencesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<GetWalletPreferencesResponse>

  putWalletPreferences(
    req: PutWalletPreferencesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutWalletPreferencesResponse>

  listWalletSigners(
    req: ListWalletSignersRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListWalletSignersResponse>

  putWalletSigner(req: PutWalletSignerRequest, headers?: object, signal?: AbortSignal): Promise<PutWalletSignerResponse>

  deleteWalletSigner(
    req: DeleteWalletSignerRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteWalletSignerResponse>

  listSessions(req: ListSessionsRequest, headers?: object, signal?: AbortSignal): Promise<ListSessionsResponse>

  putSession(req: PutSessionRequest, headers?: object, signal?: AbortSignal): Promise<PutSessionResponse>

  deleteSession(req: DeleteSessionRequest, headers?: object, signal?: AbortSignal): Promise<DeleteSessionResponse>

  listContacts(req: ListContactsRequest, headers?: object, signal?: AbortSignal): Promise<ListContactsResponse>

  putContact(req: PutContactRequest, headers?: object, signal?: AbortSignal): Promise<PutContactResponse>

  deleteContact(req: DeleteContactRequest, headers?: object, signal?: AbortSignal): Promise<DeleteContactResponse>

  listWatchedWallets(
    req: ListWatchedWalletsRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListWatchedWalletsResponse>

  putWatchedWallet(
    req: PutWatchedWalletRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutWatchedWalletResponse>

  deleteWatchedWallet(
    req: DeleteWatchedWalletRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteWatchedWalletResponse>

  listDiscoverFavorites(
    req: ListDiscoverFavoritesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListDiscoverFavoritesResponse>

  putDiscoverFavorite(
    req: PutDiscoverFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutDiscoverFavoriteResponse>

  deleteDiscoverFavorite(
    req: DeleteDiscoverFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteDiscoverFavoriteResponse>

  listDiscoverHistory(
    req: ListDiscoverHistoryRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListDiscoverHistoryResponse>

  putDiscoverHistory(
    req: PutDiscoverHistoryRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutDiscoverHistoryResponse>

  deleteDiscoverHistory(
    req: DeleteDiscoverHistoryRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteDiscoverHistoryResponse>

  listTokenFavorites(
    req: ListTokenFavoritesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListTokenFavoritesResponse>

  putTokenFavorite(
    req: PutTokenFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutTokenFavoriteResponse>

  deleteTokenFavorite(
    req: DeleteTokenFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteTokenFavoriteResponse>

  listHiddenTokens(
    req: ListHiddenTokensRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListHiddenTokensResponse>

  putHiddenToken(req: PutHiddenTokenRequest, headers?: object, signal?: AbortSignal): Promise<PutHiddenTokenResponse>

  deleteHiddenToken(
    req: DeleteHiddenTokenRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteHiddenTokenResponse>
}

//
// Schema types
//

export interface Version {
  webrpcVersion: string
  schemaVersion: string
  schemaHash: string
  appVersion: string
}

export interface RuntimeStatus {
  healthOK: boolean
  startTime: string
  uptime: number
  ver: string
  branch: string
  commitHash: string
}

export interface Wallet {
  address: string
  ecosystem?: number
  preferences: WalletPreferences
  updatedAt: string
  createdAt: string
}

export interface WalletPreferences {
  manualSigning?: boolean
  hideUnlistedTokens?: boolean
  hideCollectibles?: boolean
  includeTestnets?: boolean
  currency?: string
}

export interface WalletSigner {
  walletAddress: string
  signerAddress: string
  kind: string
  email?: string
  updatedAt: string
  createdAt: string
}

export interface Session {
  walletAddress: string
  sessionAddress: string
  ipAddress: string
  userAgent: string
  originUrl: string
  appUrl: string
  createdAt: string
}

export interface Contact {
  walletAddress: string
  contactAddress: string
  nickname: string
  updatedAt: string
  createdAt: string
}

export interface WatchedWallet {
  walletAddress: string
  watchedAddress: string
  nickname: string
  updatedAt: string
  createdAt: string
}

export interface DiscoverFavorite {
  walletAddress: string
  id: number
  dappId: string
  createdAt: string
}

export interface DiscoverHistory {
  walletAddress: string
  id: number
  dappId: string
  accessedAt: string
}

export interface TokenFavorite {
  walletAddress: string
  id: number
  chainId: string
  contractAddress: string
  tokenId: string
  createdAt: string
}

export interface HiddenToken {
  walletAddress: string
  id: number
  chainId: string
  contractAddress: string
  tokenId?: string
  createdAt: string
}

export interface SessionProps {
  address: string
  appUrl: string
}

export interface WalletSignerProps {
  address: string
  kind: string
  email?: string
}

export interface ContactProps {
  address: string
  nickname?: string
}

export interface DiscoverProps {
  dappId: string
}

export interface TokenFavoriteProps {
  chainId: string
  contractAddress: string
  tokenId: string
}

export interface HiddenTokenProps {
  chainId: string
  contractAddress: string
  tokenId?: string
}

export interface WatchedWalletProps {
  watchedAddress: string
  nickname?: string
}

export interface GetCapabilitiesRequest {}

export interface GetCapabilitiesResponse {
  supportedMethods: Array<string>
}

export interface GetAccessTokenRequest {
  ethauthProof: string
  chainId: string
}

export interface GetAccessTokenResponse {
  accessToken: string
  refreshToken: string
  expiresIn: number
}

export interface GetIdentityTokenRequest {
  claims: { [key: string]: any }
}

export interface GetIdentityTokenResponse {
  idToken: string
}

export interface GetWalletPreferencesRequest {
  wallet: string
}

export interface GetWalletPreferencesResponse {
  preferences: WalletPreferences
}

export interface PutWalletPreferencesRequest {
  wallet: string
  preferences: WalletPreferences
}

export interface PutWalletPreferencesResponse {}

export interface ListWalletSignersRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListWalletSignersResponse {
  signers: Array<WalletSigner>
  nextCursor: string
}

export interface PutWalletSignerRequest {
  wallet: string
  signer: WalletSignerProps
}

export interface PutWalletSignerResponse {
  signer: WalletSigner
}

export interface DeleteWalletSignerRequest {
  wallet: string
  signer: string
}

export interface DeleteWalletSignerResponse {}

export interface ListSessionsRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListSessionsResponse {
  sessions: Array<Session>
  nextCursor: string
}

export interface PutSessionRequest {
  wallet: string
  session: SessionProps
}

export interface PutSessionResponse {
  session: Session
}

export interface DeleteSessionRequest {
  wallet: string
  session: string
}

export interface DeleteSessionResponse {}

export interface ListContactsRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListContactsResponse {
  contacts: Array<Contact>
  nextCursor: string
}

export interface PutContactRequest {
  wallet: string
  contact: ContactProps
}

export interface PutContactResponse {
  contact: Contact
}

export interface DeleteContactRequest {
  wallet: string
  contact: string
}

export interface DeleteContactResponse {}

export interface ListWatchedWalletsRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListWatchedWalletsResponse {
  watchedWallets: Array<WatchedWallet>
  nextCursor: string
}

export interface PutWatchedWalletRequest {
  wallet: string
  watchedWallet: WatchedWalletProps
}

export interface PutWatchedWalletResponse {
  watchedWallet: WatchedWallet
}

export interface DeleteWatchedWalletRequest {
  wallet: string
  watchedWallet: string
}

export interface DeleteWatchedWalletResponse {}

export interface ListDiscoverFavoritesRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListDiscoverFavoritesResponse {
  favorites: Array<DiscoverFavorite>
  nextCursor: string
}

export interface PutDiscoverFavoriteRequest {
  wallet: string
  favorite: DiscoverProps
}

export interface PutDiscoverFavoriteResponse {
  favorite: DiscoverFavorite
}

export interface DeleteDiscoverFavoriteRequest {
  wallet: string
  id: number
}

export interface DeleteDiscoverFavoriteResponse {}

export interface ListDiscoverHistoryRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListDiscoverHistoryResponse {
  history: Array<DiscoverHistory>
  nextCursor: string
}

export interface PutDiscoverHistoryRequest {
  wallet: string
  history: DiscoverProps
}

export interface PutDiscoverHistoryResponse {
  history: DiscoverHistory
}

export interface DeleteDiscoverHistoryRequest {
  wallet: string
  id: number
}

export interface DeleteDiscoverHistoryResponse {}

export interface ListTokenFavoritesRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListTokenFavoritesResponse {
  favorites: Array<TokenFavorite>
  nextCursor: string
}

export interface PutTokenFavoriteRequest {
  wallet: string
  favorite: TokenFavoriteProps
}

export interface PutTokenFavoriteResponse {
  favorite: TokenFavorite
}

export interface DeleteTokenFavoriteRequest {
  wallet: string
  id: number
}

export interface DeleteTokenFavoriteResponse {}

export interface ListHiddenTokensRequest {
  wallet: string
  pageSize: number
  cursor: string
}

export interface ListHiddenTokensResponse {
  hiddenTokens: Array<HiddenToken>
  nextCursor: string
}

export interface PutHiddenTokenRequest {
  wallet: string
  token: HiddenTokenProps
}

export interface PutHiddenTokenResponse {
  hiddenToken: HiddenToken
}

export interface DeleteHiddenTokenRequest {
  wallet: string
  id: number
}

export interface DeleteHiddenTokenResponse {}

//
// Client
//

export class UserData implements UserDataClient {
  protected hostname: string
  protected fetch: Fetch
  protected path = '/rpc/UserData/'

  constructor(hostname: string, fetch: Fetch) {
    this.hostname = hostname.replace(/\/*$/, '')
    this.fetch = (input: RequestInfo, init?: RequestInit) => fetch(input, init)
  }

  private url(name: string): string {
    return this.hostname + this.path + name
  }

  queryKey = {
    getCapabilities: () => ['UserData', 'getCapabilities'] as const,
    getAccessToken: (req: GetAccessTokenRequest) => ['UserData', 'getAccessToken', req] as const,
    getIdentityToken: (req: GetIdentityTokenRequest) => ['UserData', 'getIdentityToken', req] as const,
    getWalletPreferences: (req: GetWalletPreferencesRequest) => ['UserData', 'getWalletPreferences', req] as const,
    putWalletPreferences: (req: PutWalletPreferencesRequest) => ['UserData', 'putWalletPreferences', req] as const,
    listWalletSigners: (req: ListWalletSignersRequest) => ['UserData', 'listWalletSigners', req] as const,
    putWalletSigner: (req: PutWalletSignerRequest) => ['UserData', 'putWalletSigner', req] as const,
    deleteWalletSigner: (req: DeleteWalletSignerRequest) => ['UserData', 'deleteWalletSigner', req] as const,
    listSessions: (req: ListSessionsRequest) => ['UserData', 'listSessions', req] as const,
    putSession: (req: PutSessionRequest) => ['UserData', 'putSession', req] as const,
    deleteSession: (req: DeleteSessionRequest) => ['UserData', 'deleteSession', req] as const,
    listContacts: (req: ListContactsRequest) => ['UserData', 'listContacts', req] as const,
    putContact: (req: PutContactRequest) => ['UserData', 'putContact', req] as const,
    deleteContact: (req: DeleteContactRequest) => ['UserData', 'deleteContact', req] as const,
    listWatchedWallets: (req: ListWatchedWalletsRequest) => ['UserData', 'listWatchedWallets', req] as const,
    putWatchedWallet: (req: PutWatchedWalletRequest) => ['UserData', 'putWatchedWallet', req] as const,
    deleteWatchedWallet: (req: DeleteWatchedWalletRequest) => ['UserData', 'deleteWatchedWallet', req] as const,
    listDiscoverFavorites: (req: ListDiscoverFavoritesRequest) => ['UserData', 'listDiscoverFavorites', req] as const,
    putDiscoverFavorite: (req: PutDiscoverFavoriteRequest) => ['UserData', 'putDiscoverFavorite', req] as const,
    deleteDiscoverFavorite: (req: DeleteDiscoverFavoriteRequest) =>
      ['UserData', 'deleteDiscoverFavorite', req] as const,
    listDiscoverHistory: (req: ListDiscoverHistoryRequest) => ['UserData', 'listDiscoverHistory', req] as const,
    putDiscoverHistory: (req: PutDiscoverHistoryRequest) => ['UserData', 'putDiscoverHistory', req] as const,
    deleteDiscoverHistory: (req: DeleteDiscoverHistoryRequest) => ['UserData', 'deleteDiscoverHistory', req] as const,
    listTokenFavorites: (req: ListTokenFavoritesRequest) => ['UserData', 'listTokenFavorites', req] as const,
    putTokenFavorite: (req: PutTokenFavoriteRequest) => ['UserData', 'putTokenFavorite', req] as const,
    deleteTokenFavorite: (req: DeleteTokenFavoriteRequest) => ['UserData', 'deleteTokenFavorite', req] as const,
    listHiddenTokens: (req: ListHiddenTokensRequest) => ['UserData', 'listHiddenTokens', req] as const,
    putHiddenToken: (req: PutHiddenTokenRequest) => ['UserData', 'putHiddenToken', req] as const,
    deleteHiddenToken: (req: DeleteHiddenTokenRequest) => ['UserData', 'deleteHiddenToken', req] as const,
  }

  getCapabilities = (headers?: object, signal?: AbortSignal): Promise<GetCapabilitiesResponse> => {
    return this.fetch(this.url('GetCapabilities'), createHttpRequest('{}', headers, signal)).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<GetCapabilitiesResponse>(_data, 'GetCapabilitiesResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  getAccessToken = (
    req: GetAccessTokenRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<GetAccessTokenResponse> => {
    return this.fetch(
      this.url('GetAccessToken'),
      createHttpRequest(JsonEncode(req, 'GetAccessTokenRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<GetAccessTokenResponse>(_data, 'GetAccessTokenResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  getIdentityToken = (
    req: GetIdentityTokenRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<GetIdentityTokenResponse> => {
    return this.fetch(
      this.url('GetIdentityToken'),
      createHttpRequest(JsonEncode(req, 'GetIdentityTokenRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<GetIdentityTokenResponse>(_data, 'GetIdentityTokenResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  getWalletPreferences = (
    req: GetWalletPreferencesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<GetWalletPreferencesResponse> => {
    return this.fetch(
      this.url('GetWalletPreferences'),
      createHttpRequest(JsonEncode(req, 'GetWalletPreferencesRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<GetWalletPreferencesResponse>(_data, 'GetWalletPreferencesResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putWalletPreferences = (
    req: PutWalletPreferencesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutWalletPreferencesResponse> => {
    return this.fetch(
      this.url('PutWalletPreferences'),
      createHttpRequest(JsonEncode(req, 'PutWalletPreferencesRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutWalletPreferencesResponse>(_data, 'PutWalletPreferencesResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listWalletSigners = (
    req: ListWalletSignersRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListWalletSignersResponse> => {
    return this.fetch(
      this.url('ListWalletSigners'),
      createHttpRequest(JsonEncode(req, 'ListWalletSignersRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListWalletSignersResponse>(_data, 'ListWalletSignersResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putWalletSigner = (
    req: PutWalletSignerRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutWalletSignerResponse> => {
    return this.fetch(
      this.url('PutWalletSigner'),
      createHttpRequest(JsonEncode(req, 'PutWalletSignerRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutWalletSignerResponse>(_data, 'PutWalletSignerResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteWalletSigner = (
    req: DeleteWalletSignerRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteWalletSignerResponse> => {
    return this.fetch(
      this.url('DeleteWalletSigner'),
      createHttpRequest(JsonEncode(req, 'DeleteWalletSignerRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteWalletSignerResponse>(_data, 'DeleteWalletSignerResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listSessions = (req: ListSessionsRequest, headers?: object, signal?: AbortSignal): Promise<ListSessionsResponse> => {
    return this.fetch(
      this.url('ListSessions'),
      createHttpRequest(JsonEncode(req, 'ListSessionsRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListSessionsResponse>(_data, 'ListSessionsResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putSession = (req: PutSessionRequest, headers?: object, signal?: AbortSignal): Promise<PutSessionResponse> => {
    return this.fetch(
      this.url('PutSession'),
      createHttpRequest(JsonEncode(req, 'PutSessionRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutSessionResponse>(_data, 'PutSessionResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteSession = (
    req: DeleteSessionRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteSessionResponse> => {
    return this.fetch(
      this.url('DeleteSession'),
      createHttpRequest(JsonEncode(req, 'DeleteSessionRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteSessionResponse>(_data, 'DeleteSessionResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listContacts = (req: ListContactsRequest, headers?: object, signal?: AbortSignal): Promise<ListContactsResponse> => {
    return this.fetch(
      this.url('ListContacts'),
      createHttpRequest(JsonEncode(req, 'ListContactsRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListContactsResponse>(_data, 'ListContactsResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putContact = (req: PutContactRequest, headers?: object, signal?: AbortSignal): Promise<PutContactResponse> => {
    return this.fetch(
      this.url('PutContact'),
      createHttpRequest(JsonEncode(req, 'PutContactRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutContactResponse>(_data, 'PutContactResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteContact = (
    req: DeleteContactRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteContactResponse> => {
    return this.fetch(
      this.url('DeleteContact'),
      createHttpRequest(JsonEncode(req, 'DeleteContactRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteContactResponse>(_data, 'DeleteContactResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listWatchedWallets = (
    req: ListWatchedWalletsRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListWatchedWalletsResponse> => {
    return this.fetch(
      this.url('ListWatchedWallets'),
      createHttpRequest(JsonEncode(req, 'ListWatchedWalletsRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListWatchedWalletsResponse>(_data, 'ListWatchedWalletsResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putWatchedWallet = (
    req: PutWatchedWalletRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutWatchedWalletResponse> => {
    return this.fetch(
      this.url('PutWatchedWallet'),
      createHttpRequest(JsonEncode(req, 'PutWatchedWalletRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutWatchedWalletResponse>(_data, 'PutWatchedWalletResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteWatchedWallet = (
    req: DeleteWatchedWalletRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteWatchedWalletResponse> => {
    return this.fetch(
      this.url('DeleteWatchedWallet'),
      createHttpRequest(JsonEncode(req, 'DeleteWatchedWalletRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteWatchedWalletResponse>(_data, 'DeleteWatchedWalletResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listDiscoverFavorites = (
    req: ListDiscoverFavoritesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListDiscoverFavoritesResponse> => {
    return this.fetch(
      this.url('ListDiscoverFavorites'),
      createHttpRequest(JsonEncode(req, 'ListDiscoverFavoritesRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListDiscoverFavoritesResponse>(_data, 'ListDiscoverFavoritesResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putDiscoverFavorite = (
    req: PutDiscoverFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutDiscoverFavoriteResponse> => {
    return this.fetch(
      this.url('PutDiscoverFavorite'),
      createHttpRequest(JsonEncode(req, 'PutDiscoverFavoriteRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutDiscoverFavoriteResponse>(_data, 'PutDiscoverFavoriteResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteDiscoverFavorite = (
    req: DeleteDiscoverFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteDiscoverFavoriteResponse> => {
    return this.fetch(
      this.url('DeleteDiscoverFavorite'),
      createHttpRequest(JsonEncode(req, 'DeleteDiscoverFavoriteRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteDiscoverFavoriteResponse>(_data, 'DeleteDiscoverFavoriteResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listDiscoverHistory = (
    req: ListDiscoverHistoryRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListDiscoverHistoryResponse> => {
    return this.fetch(
      this.url('ListDiscoverHistory'),
      createHttpRequest(JsonEncode(req, 'ListDiscoverHistoryRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListDiscoverHistoryResponse>(_data, 'ListDiscoverHistoryResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putDiscoverHistory = (
    req: PutDiscoverHistoryRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutDiscoverHistoryResponse> => {
    return this.fetch(
      this.url('PutDiscoverHistory'),
      createHttpRequest(JsonEncode(req, 'PutDiscoverHistoryRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutDiscoverHistoryResponse>(_data, 'PutDiscoverHistoryResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteDiscoverHistory = (
    req: DeleteDiscoverHistoryRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteDiscoverHistoryResponse> => {
    return this.fetch(
      this.url('DeleteDiscoverHistory'),
      createHttpRequest(JsonEncode(req, 'DeleteDiscoverHistoryRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteDiscoverHistoryResponse>(_data, 'DeleteDiscoverHistoryResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listTokenFavorites = (
    req: ListTokenFavoritesRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListTokenFavoritesResponse> => {
    return this.fetch(
      this.url('ListTokenFavorites'),
      createHttpRequest(JsonEncode(req, 'ListTokenFavoritesRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListTokenFavoritesResponse>(_data, 'ListTokenFavoritesResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putTokenFavorite = (
    req: PutTokenFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutTokenFavoriteResponse> => {
    return this.fetch(
      this.url('PutTokenFavorite'),
      createHttpRequest(JsonEncode(req, 'PutTokenFavoriteRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutTokenFavoriteResponse>(_data, 'PutTokenFavoriteResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteTokenFavorite = (
    req: DeleteTokenFavoriteRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteTokenFavoriteResponse> => {
    return this.fetch(
      this.url('DeleteTokenFavorite'),
      createHttpRequest(JsonEncode(req, 'DeleteTokenFavoriteRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteTokenFavoriteResponse>(_data, 'DeleteTokenFavoriteResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  listHiddenTokens = (
    req: ListHiddenTokensRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<ListHiddenTokensResponse> => {
    return this.fetch(
      this.url('ListHiddenTokens'),
      createHttpRequest(JsonEncode(req, 'ListHiddenTokensRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<ListHiddenTokensResponse>(_data, 'ListHiddenTokensResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  putHiddenToken = (
    req: PutHiddenTokenRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<PutHiddenTokenResponse> => {
    return this.fetch(
      this.url('PutHiddenToken'),
      createHttpRequest(JsonEncode(req, 'PutHiddenTokenRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<PutHiddenTokenResponse>(_data, 'PutHiddenTokenResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }

  deleteHiddenToken = (
    req: DeleteHiddenTokenRequest,
    headers?: object,
    signal?: AbortSignal,
  ): Promise<DeleteHiddenTokenResponse> => {
    return this.fetch(
      this.url('DeleteHiddenToken'),
      createHttpRequest(JsonEncode(req, 'DeleteHiddenTokenRequest'), headers, signal),
    ).then(
      (res) => {
        return buildResponse(res).then((_data) => {
          return JsonDecode<DeleteHiddenTokenResponse>(_data, 'DeleteHiddenTokenResponse')
        })
      },
      (error) => {
        throw WebrpcRequestFailedError.new({
          cause: `fetch(): ${error instanceof Error ? error.message : String(error)}`,
        })
      },
    )
  }
}

const createHttpRequest = (body: string = '{}', headers: object = {}, signal: AbortSignal | null = null): object => {
  const reqHeaders: { [key: string]: string } = { ...headers, 'Content-Type': 'application/json' }
  return { method: 'POST', headers: reqHeaders, body, signal }
}

const buildResponse = (res: Response): Promise<any> => {
  return res.text().then((text) => {
    let data
    try {
      data = JSON.parse(text)
    } catch (error) {
      throw WebrpcBadResponseError.new({
        status: res.status,
        cause: `JSON.parse(): ${error instanceof Error ? error.message : String(error)}: response text: ${text}`,
      })
    }
    if (!res.ok) {
      const code: number = typeof data.code === 'number' ? data.code : 0
      throw (webrpcErrorByCode[code] || WebrpcError).new(data)
    }
    return data
  })
}

export type Fetch = (input: RequestInfo, init?: RequestInit) => Promise<Response>

export const JsonEncode = <T = any>(obj: T, _typ: string = ''): string => {
  return JSON.stringify(obj)
}

export const JsonDecode = <T = any>(data: string | any, _typ: string = ''): T => {
  let parsed: any = data
  if (typeof data === 'string') {
    try {
      parsed = JSON.parse(data)
    } catch (err) {
      throw WebrpcBadResponseError.new({ cause: `JsonDecode: JSON.parse failed: ${(err as Error).message}` })
    }
  }
  return parsed as T
}

//
// Errors
//

type WebrpcErrorParams = { name?: string; code?: number; message?: string; status?: number; cause?: string }

export class WebrpcError extends Error {
  code: number
  status: number

  constructor(error: WebrpcErrorParams = {}) {
    super(error.message)
    this.name = error.name || 'WebrpcEndpointError'
    this.code = typeof error.code === 'number' ? error.code : 0
    this.message = error.message || `endpoint error`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcError.prototype)
  }

  static new(payload: any): WebrpcError {
    return new this({ message: payload.message, code: payload.code, status: payload.status, cause: payload.cause })
  }
}

export class WebrpcEndpointError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcEndpoint'
    this.code = typeof error.code === 'number' ? error.code : 0
    this.message = error.message || `endpoint error`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcEndpointError.prototype)
  }
}

export class WebrpcRequestFailedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcRequestFailed'
    this.code = typeof error.code === 'number' ? error.code : -1
    this.message = error.message || `request failed`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcRequestFailedError.prototype)
  }
}

export class WebrpcBadRouteError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcBadRoute'
    this.code = typeof error.code === 'number' ? error.code : -2
    this.message = error.message || `bad route`
    this.status = typeof error.status === 'number' ? error.status : 404
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcBadRouteError.prototype)
  }
}

export class WebrpcBadMethodError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcBadMethod'
    this.code = typeof error.code === 'number' ? error.code : -3
    this.message = error.message || `bad method`
    this.status = typeof error.status === 'number' ? error.status : 405
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcBadMethodError.prototype)
  }
}

export class WebrpcBadRequestError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcBadRequest'
    this.code = typeof error.code === 'number' ? error.code : -4
    this.message = error.message || `bad request`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcBadRequestError.prototype)
  }
}

export class WebrpcBadResponseError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcBadResponse'
    this.code = typeof error.code === 'number' ? error.code : -5
    this.message = error.message || `bad response`
    this.status = typeof error.status === 'number' ? error.status : 500
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcBadResponseError.prototype)
  }
}

export class WebrpcServerPanicError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcServerPanic'
    this.code = typeof error.code === 'number' ? error.code : -6
    this.message = error.message || `server panic`
    this.status = typeof error.status === 'number' ? error.status : 500
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcServerPanicError.prototype)
  }
}

export class WebrpcInternalErrorError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcInternalError'
    this.code = typeof error.code === 'number' ? error.code : -7
    this.message = error.message || `internal error`
    this.status = typeof error.status === 'number' ? error.status : 500
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcInternalErrorError.prototype)
  }
}

export class WebrpcClientAbortedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcClientAborted'
    this.code = typeof error.code === 'number' ? error.code : -8
    this.message = error.message || `request aborted by client`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcClientAbortedError.prototype)
  }
}

export class WebrpcStreamLostError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcStreamLost'
    this.code = typeof error.code === 'number' ? error.code : -9
    this.message = error.message || `stream lost`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcStreamLostError.prototype)
  }
}

export class WebrpcStreamFinishedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'WebrpcStreamFinished'
    this.code = typeof error.code === 'number' ? error.code : -10
    this.message = error.message || `stream finished`
    this.status = typeof error.status === 'number' ? error.status : 200
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, WebrpcStreamFinishedError.prototype)
  }
}

//
// Schema errors
//

export class UnauthorizedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'Unauthorized'
    this.code = typeof error.code === 'number' ? error.code : 1000
    this.message = error.message || `Unauthorized access`
    this.status = typeof error.status === 'number' ? error.status : 401
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, UnauthorizedError.prototype)
  }
}

export class PermissionDeniedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'PermissionDenied'
    this.code = typeof error.code === 'number' ? error.code : 1001
    this.message = error.message || `Permission denied`
    this.status = typeof error.status === 'number' ? error.status : 403
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, PermissionDeniedError.prototype)
  }
}

export class SessionExpiredError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'SessionExpired'
    this.code = typeof error.code === 'number' ? error.code : 1002
    this.message = error.message || `Session expired`
    this.status = typeof error.status === 'number' ? error.status : 403
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, SessionExpiredError.prototype)
  }
}

export class MethodNotFoundError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'MethodNotFound'
    this.code = typeof error.code === 'number' ? error.code : 1003
    this.message = error.message || `Method not found`
    this.status = typeof error.status === 'number' ? error.status : 404
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, MethodNotFoundError.prototype)
  }
}

export class RequestConflictError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'RequestConflict'
    this.code = typeof error.code === 'number' ? error.code : 1004
    this.message = error.message || `Conflict with target resource`
    this.status = typeof error.status === 'number' ? error.status : 409
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, RequestConflictError.prototype)
  }
}

export class AbortedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'Aborted'
    this.code = typeof error.code === 'number' ? error.code : 1005
    this.message = error.message || `Request aborted`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, AbortedError.prototype)
  }
}

export class GeoblockedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'Geoblocked'
    this.code = typeof error.code === 'number' ? error.code : 1006
    this.message = error.message || `Geoblocked region`
    this.status = typeof error.status === 'number' ? error.status : 451
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, GeoblockedError.prototype)
  }
}

export class RateLimitedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'RateLimited'
    this.code = typeof error.code === 'number' ? error.code : 1007
    this.message = error.message || `Rate-limited. Please slow down.`
    this.status = typeof error.status === 'number' ? error.status : 429
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, RateLimitedError.prototype)
  }
}

export class ProjectNotFoundError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'ProjectNotFound'
    this.code = typeof error.code === 'number' ? error.code : 1008
    this.message = error.message || `Project not found`
    this.status = typeof error.status === 'number' ? error.status : 401
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, ProjectNotFoundError.prototype)
  }
}

export class InvalidArgumentError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'InvalidArgument'
    this.code = typeof error.code === 'number' ? error.code : 2000
    this.message = error.message || `Invalid argument`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, InvalidArgumentError.prototype)
  }
}

export class UnavailableError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'Unavailable'
    this.code = typeof error.code === 'number' ? error.code : 2002
    this.message = error.message || `Unavailable resource`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, UnavailableError.prototype)
  }
}

export class QueryFailedError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'QueryFailed'
    this.code = typeof error.code === 'number' ? error.code : 2003
    this.message = error.message || `Query failed`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, QueryFailedError.prototype)
  }
}

export class NotFoundError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'NotFound'
    this.code = typeof error.code === 'number' ? error.code : 3000
    this.message = error.message || `Resource not found`
    this.status = typeof error.status === 'number' ? error.status : 400
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, NotFoundError.prototype)
  }
}

export class UnsupportedNetworkError extends WebrpcError {
  constructor(error: WebrpcErrorParams = {}) {
    super(error)
    this.name = error.name || 'UnsupportedNetwork'
    this.code = typeof error.code === 'number' ? error.code : 3008
    this.message = error.message || `Unsupported network`
    this.status = typeof error.status === 'number' ? error.status : 422
    if (error.cause !== undefined) this.cause = error.cause
    Object.setPrototypeOf(this, UnsupportedNetworkError.prototype)
  }
}

export enum errors {
  WebrpcEndpoint = 'WebrpcEndpoint',
  WebrpcRequestFailed = 'WebrpcRequestFailed',
  WebrpcBadRoute = 'WebrpcBadRoute',
  WebrpcBadMethod = 'WebrpcBadMethod',
  WebrpcBadRequest = 'WebrpcBadRequest',
  WebrpcBadResponse = 'WebrpcBadResponse',
  WebrpcServerPanic = 'WebrpcServerPanic',
  WebrpcInternalError = 'WebrpcInternalError',
  WebrpcClientAborted = 'WebrpcClientAborted',
  WebrpcStreamLost = 'WebrpcStreamLost',
  WebrpcStreamFinished = 'WebrpcStreamFinished',
  Unauthorized = 'Unauthorized',
  PermissionDenied = 'PermissionDenied',
  SessionExpired = 'SessionExpired',
  MethodNotFound = 'MethodNotFound',
  RequestConflict = 'RequestConflict',
  Aborted = 'Aborted',
  Geoblocked = 'Geoblocked',
  RateLimited = 'RateLimited',
  ProjectNotFound = 'ProjectNotFound',
  InvalidArgument = 'InvalidArgument',
  Unavailable = 'Unavailable',
  QueryFailed = 'QueryFailed',
  NotFound = 'NotFound',
  UnsupportedNetwork = 'UnsupportedNetwork',
}

export enum WebrpcErrorCodes {
  WebrpcEndpoint = 0,
  WebrpcRequestFailed = -1,
  WebrpcBadRoute = -2,
  WebrpcBadMethod = -3,
  WebrpcBadRequest = -4,
  WebrpcBadResponse = -5,
  WebrpcServerPanic = -6,
  WebrpcInternalError = -7,
  WebrpcClientAborted = -8,
  WebrpcStreamLost = -9,
  WebrpcStreamFinished = -10,
  Unauthorized = 1000,
  PermissionDenied = 1001,
  SessionExpired = 1002,
  MethodNotFound = 1003,
  RequestConflict = 1004,
  Aborted = 1005,
  Geoblocked = 1006,
  RateLimited = 1007,
  ProjectNotFound = 1008,
  InvalidArgument = 2000,
  Unavailable = 2002,
  QueryFailed = 2003,
  NotFound = 3000,
  UnsupportedNetwork = 3008,
}

export const webrpcErrorByCode: { [code: number]: any } = {
  [0]: WebrpcEndpointError,
  [-1]: WebrpcRequestFailedError,
  [-2]: WebrpcBadRouteError,
  [-3]: WebrpcBadMethodError,
  [-4]: WebrpcBadRequestError,
  [-5]: WebrpcBadResponseError,
  [-6]: WebrpcServerPanicError,
  [-7]: WebrpcInternalErrorError,
  [-8]: WebrpcClientAbortedError,
  [-9]: WebrpcStreamLostError,
  [-10]: WebrpcStreamFinishedError,
  [1000]: UnauthorizedError,
  [1001]: PermissionDeniedError,
  [1002]: SessionExpiredError,
  [1003]: MethodNotFoundError,
  [1004]: RequestConflictError,
  [1005]: AbortedError,
  [1006]: GeoblockedError,
  [1007]: RateLimitedError,
  [1008]: ProjectNotFoundError,
  [2000]: InvalidArgumentError,
  [2002]: UnavailableError,
  [2003]: QueryFailedError,
  [3000]: NotFoundError,
  [3008]: UnsupportedNetworkError,
}

//
// Webrpc
//

export const WebrpcHeader = 'Webrpc'

export const WebrpcHeaderValue = 'webrpc@v0.30.2;gen-typescript@v0.22.2;userdata@v0.1.0'

type WebrpcGenVersions = {
  WebrpcGenVersion: string
  codeGenName: string
  codeGenVersion: string
  schemaName: string
  schemaVersion: string
}

export function VersionFromHeader(headers: Headers): WebrpcGenVersions {
  const headerValue = headers.get(WebrpcHeader)
  if (!headerValue) {
    return {
      WebrpcGenVersion: '',
      codeGenName: '',
      codeGenVersion: '',
      schemaName: '',
      schemaVersion: '',
    }
  }

  return parseWebrpcGenVersions(headerValue)
}

function parseWebrpcGenVersions(header: string): WebrpcGenVersions {
  const versions = header.split(';')
  if (versions.length < 3) {
    return {
      WebrpcGenVersion: '',
      codeGenName: '',
      codeGenVersion: '',
      schemaName: '',
      schemaVersion: '',
    }
  }

  const [_, WebrpcGenVersion] = versions[0]!.split('@')
  const [codeGenName, codeGenVersion] = versions[1]!.split('@')
  const [schemaName, schemaVersion] = versions[2]!.split('@')

  return {
    WebrpcGenVersion: WebrpcGenVersion ?? '',
    codeGenName: codeGenName ?? '',
    codeGenVersion: codeGenVersion ?? '',
    schemaName: schemaName ?? '',
    schemaVersion: schemaVersion ?? '',
  }
}
